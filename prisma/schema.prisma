// This file was generated by Prisma, do not edit manually. https://pris.ly/d/prisma-schema
// Safe minimal schema - only commission tables + existing bubble tables for types

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ========================================
// EXISTING BUBBLE.IO TABLES (READ-ONLY)
// ========================================

model synced_records {
  id             String   @id @default(cuid())
  bubble_id      String   @unique
  data_type      String
  raw_data       Json
  processed_data Json?
  synced_at      DateTime @default(now())
  updated_at     DateTime @default(now())

  @@index([data_type])
  @@index([synced_at])
}

// ========================================
// NEW COMMISSION TABLES (ADMIN DASHBOARD)
// ========================================

model commission_adjustment {
  id                  String    @id @default(cuid())
  created_at          DateTime  @default(now())
  updated_at          DateTime  @updatedAt
  agent_id            String
  agent_name          String
  amount              Decimal
  description         String
  created_by          String
  report_id           String?
  adjustment_month    String?
  generated_commission_report generated_commission_report? @relation(fields: [report_id], references: [report_id])
}

model generated_commission_report {
  report_id String @id
  agent_id String
  agent_name String
  month_period String
  total_basic_commission Decimal
  total_bonus_commission Decimal
  total_adjustments Decimal
  final_total_commission Decimal
  commission_paid Boolean
  invoice_bubble_ids Json
  created_at DateTime
  created_by String?
  paid_at DateTime?
  paid_by String?
  linked_adjustment commission_adjustment[]
}

// ========================================
// SEDA REGISTRATION & CUSTOMER TABLES
// ========================================

model seda_registration {
  id                    Int     @id @default(autoincrement())
  bubble_id             String? @unique
  city                  String?
  drawing_system_submitted Boolean?
  created_date          DateTime?
  created_by            String?
  roof_images           String?
  system_size           String?
  system_size_in_form_kwp Decimal?
  project_price         Decimal?
  agent                 String?
  state                 String?
  modified_date         DateTime?
  reg_status            String?
  linked_customer       String?
  sunpeak_hours         Decimal?
  redex_status          String?
  installation_address  String?

  customer_profile customer_profile? @relation(fields: [linked_customer], references: [bubble_id])
}

model customer_profile {
  id          Int     @id @default(autoincrement())
  bubble_id   String? @unique
  contact     String?
  state       String?
  name        String?

  seda_registrations seda_registration[]
}

